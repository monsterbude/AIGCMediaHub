# AIGC Media Hub 用户操作手册

AIGC Media Hub 是一款专为 AI 创作者设计的本地媒体管理工具。它能够自动解析 WebUI 和 ComfyUI 生成图片的元数据（Prompt, Model, LoRA 等），并提供高效的浏览、搜索与收藏功能。

## 1. 项目初始化

在开始使用之前，请确保您的系统中已安装 [Node.js](https://nodejs.org/) (建议从 v18+ 开始)。

### 1.1 安装依赖

打开终端，进入项目根目录执行：

```bash
npm install
```

### 1.2 数据库初始化

本项目使用 SQLite 存储元数据。执行以下命令生成数据库文件并应用表结构：

```bash
npx prisma migrate dev --name init
```

### 1.3 启动项目

启动开发服务器：

```bash
npm run dev
```

启动后，访问 [http://localhost:3000](http://localhost:3000) 即可进入管理界面。

## 2. 操作指南

### 2.1 扫描本地资产

1. **输入路径**：在左侧边栏的输入框中输入您存放 AI 生成图的绝对路径（例如 `D:\StableDiffusion\outputs`）。
2. **执行扫描**：点击旁边的 `+` (Scan) 按钮。
   - 系统将递归遍历所有子文件夹。
   - 自动生成缩略图（存放于 `.cache` 目录，提升后续加载速度）。
   - 自动提取图片中的 AIGC 参数（支持 WebUI PNG Info 和 ComfyUI JSON 格式）。
3. **实时日志**：您可以点击右下角的日志按钮查看扫描进度。

### 2.2 浏览与筛选

- **目录树**：左侧边栏提供优化的目录树。对于深层级目录，系统会自动进行“路径收缩”（Path Compacting），显示为 `起始目录 › ... › 目标目录`。
- **高级筛选 (Advanced Filters)**：
  - 点击侧栏的 Advanced Filters 展开标签面板。
  - 标签按 **Models (底模)**, **LoRAs**, **Tools (工具)** 进行自动归类。
  - 支持“多选过滤”（AND 逻辑），精准定位特定组合生成的图片。
- **收藏夹**：点击筛选栏顶部的“金色星星”按钮，可一键仅显示您收藏的精选作品。

### 2.3 资产管理

- **卡片交互**：
  - **悬浮操作**：鼠标悬停在卡片上，可点击快捷按钮：
    - `Copy Prompt`：一键复制原始提示词。
    - `Star`：收藏/取消收藏。
    - `Info`：在右侧弹出详细参数。
- **详情侧栏**：点击图片或 Info 按钮，右侧会展示完整的生成参数（Seed, Sampler, CFG, Prompt 等），并支持一键复制路径。
- **全屏预览**：双击图片进入全屏 Lightbox 模式，支持鼠标滚轮缩放与拖拽查看细节。

### 2.4 数据导出

- **路径导出**：在主界面顶部点击 `Export Paths`，系统会根据您当前的筛选结果（搜索关键词、标签、目录等），将所有匹配文件的**绝对路径**以列表形式复制到剪贴板。

## 3. 常见问题

- **找不到图片？** 确保路径正确且图片包含标准的 WebUI/ComfyUI 元数据。
- **加载慢？** 首次扫描会生成缩略图，完成后再次访问将非常流畅。
- **重新扫描**：如果目录下的文件发生了变动，再次点击 `Scan` 按钮即可同步更新（会自动清理已删除文件的记录）。

---
